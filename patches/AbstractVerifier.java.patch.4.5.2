--- AbstractVerifier.java	2016-05-16 15:46:13.000000000 -0700
+++ AbstractVerifier2.java	2016-05-16 15:51:35.000000000 -0700
@@ -137,7 +137,7 @@
         final int subjectType = ipv4 || ipv6 ? DefaultHostnameVerifier.IP_ADDRESS_TYPE : DefaultHostnameVerifier.DNS_NAME_TYPE;
         final List<String> subjectAlts = DefaultHostnameVerifier.extractSubjectAlts(cert, subjectType);
         final X500Principal subjectPrincipal = cert.getSubjectX500Principal();
-        final String cn = DefaultHostnameVerifier.extractCN(subjectPrincipal.getName(X500Principal.RFC2253));
+        final String cn = new DistinguishedNameParser(subjectPrincipal).findMostSpecific("cn");
         verify(host,
                 cn != null ? new String[] {cn} : null,
                 subjectAlts != null && !subjectAlts.isEmpty() ? subjectAlts.toArray(new String[subjectAlts.size()]) : null);
@@ -219,13 +219,8 @@
     }
 
     public static String[] getCNs(final X509Certificate cert) {
-        final String subjectPrincipal = cert.getSubjectX500Principal().toString();
-        try {
-            final String cn = DefaultHostnameVerifier.extractCN(subjectPrincipal);
-            return cn != null ? new String[] { cn } : null;
-        } catch (final SSLException ex) {
-            return null;
-        }
+        final String cn = new DistinguishedNameParser(cert.getSubjectX500Principal()).findMostSpecific("cn");
+        return cn != null ? new String[] { cn } : null;
     }
 
     /**
